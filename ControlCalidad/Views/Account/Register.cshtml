@model ControlCalidad.Models.RegisterViewModel
@*
    @{
        ViewBag.Title = "Register";
    }
*@

@{

    if( User.IsInRole( "Jefe" ) )
    {

        <h3 class="text-grey">Registrar Usuario</h3>
        <div class="margin-b1">
            <hr />
        </div>

        <div class="row container">
            <div class="col s8 offset-s2">
                <div class="card hoverable">
                    <nav>
                        <div class="nav-wrapper black">
                            <p class="col s4">Quality Expert S.A</p>
                        </div>
                    </nav>
                    <div class="margin-b section">
                    </div>
                    @using( Ajax.BeginForm( "Register" , "Account" , new AjaxOptions {
                        HttpMethod = "POST" ,
                        LoadingElementId = "loading" ,
                        OnSuccess = "redirectToPage('../../LoginUsers/Index')" ,
                        OnComplete = "complete" ,
                        //OnFailure = "showError"*/

                    } ) )
                    {

                        <h5 class="text-grey col s10 offset-s3">Registrar nuevo usuario</h5>
                        @Html.AntiForgeryToken( );
                        @Html.ValidationSummary(true, "errorR", new { @class = "text-error"} )
                        @Ajax.ViewContext.ViewBag.errorR;


                        <div class="row margin-b">
                            <div class="input-field col s6 offset-s3">
                                <i class="text-grey material-icons prefix">mail</i>
                                <input class="validate form-control" type="email" name="Email" id="Email" required />
                                <label for="Email">Correo</label>
                                @Html.LabelFor( m => m.Email , new { @class = ""} )
                                @Html.ValidationMessageFor( m => m.Email , null , new { @class = "text-error"} )
                            </div>
                        </div>

                        <div class="row margin-b">
                            <i class=" small text-grey col s1 offset-s3 material-icons prefix">work</i>
                            <div class="input-field col s5">
                                @Html.ValidationMessageFor( m => m.Role , null , new {@class = "text-error"} )
                                <select id="Role" name="Role" required>
                                    <option value="" disabled selected>Selecciona un rol</option>
                                    <option value="Jefe">Jefe</option>
                                    <option value="Lider">Lider</option>
                                    <option value="Tester">Tester</option>
                                    <option value="Cliente">Cliente</option>
                                </select>
                                <label for="Role">Rol</label>
                            </div>
                        </div>

                        <div class="row margin-b">
                            <div class="input-field col s6  offset-s3">
                                <i class="text-grey material-icons prefix">lock</i>
                                <input class="validate form-control" type="password" name="Password" id="Password" required />
                                @Html.LabelFor( m => m.Password , new {@class = "" } )
                                @Html.ValidationMessageFor( m => m.Password , null , new {@class = "text-error"} )
                            </div>
                        </div>

                        <div class="row margin-b">
                            <div class="input-field col s6  offset-s3">
                                <i class=" text-grey material-icons prefix">lock</i>
                                <input class="validate form-control" type="password" name="ConfirmPassword" id="ConfirmPassword" required />
                                @Html.LabelFor( m => m.ConfirmPassword , new {@class = "" } )
                                @Html.ValidationMessageFor( m => m.ConfirmPassword , null , new { @class = "text-error" } )
                            </div>
                        </div>



                        <div class=" row container center" id="loading" style="display:none;">
                            <div class="">
                                <i class="material-icons text-turq ">info_outline</i>
                            </div>
                            <div class="">
                                <p class="text-turq">
                                    Registrando... Por favor espere.
                                </p>
                            </div>
                            <div class="progress">
                                <div class="indeterminate"></div>
                            </div>
                        </div>

                        <div class=" row container center hide " id="complete">
                            <div class="">
                                <i class="material-icons text-turq ">info_outline</i>
                            </div>
                            <div class="">
                                <p class="text-turq">
                                    Se registró correctamente.
                                </p>
                            </div>
                        </div>

                        <div class="margin-b1">
                        </div>

                        <div class="row center">
                            @Html.ActionLink("Cancelar", "../LoginUsers/Index", null, new {@class = "margin-r waves-effect red-hover btn red accent-4"} )
                            <button type="submit" class=" margin-l btn waves-effect waves-light turq btn-login modal-trigger">REGISTRAR</button>
                        </div>

                        <div class="margin-b section">
                        </div>
                    }
                </div>
            </div>


        </div>

    }
    else
    {
        <div class="row container center top-m-block">

            <div class="card hoverable s10 section">

                <h3>Lo sentimos.<br />Debes iniciar sesión como <span class="red-text"> jefe </span> para registrar usuarios.</h3>
                <i class="large material-icons red-text">block</i>

            </div>
        </div>
    }

}


@section Scripts {
    @Scripts.Render( "~/bundles/jqueryval" )
}


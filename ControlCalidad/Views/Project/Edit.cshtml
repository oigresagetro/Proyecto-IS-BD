@model ControlCalidad.Models.Proyecto

@*  {
        ViewBag.Title = "Edit";

    }
*@



<h3 class="text-grey">Editar Proyecto</h3>
<div class="margin-b1">
    <hr />
</div>

@{
    List<SelectListItem> clientsId = ( List<SelectListItem> ) ViewBag.allClientsId;
    List<SelectListItem> leaders = ( List<SelectListItem> ) ViewBag.leaders;

    if( User.IsInRole( "Jefe" ) )
    {

        <div class="row container">
            <div class="col s8 offset-s2">
                <div class="card hoverable">
                    <nav>
                        <div class="nav-wrapper black">
                            <p class="col s4"> Quality Expert S.A</p>
                        </div>
                    </nav>
                    @using( Ajax.BeginForm( "Edit" , new AjaxOptions {
                        HttpMethod = "POST" ,
                        LoadingElementId = "loading" ,
                        OnSuccess = "redirectToPage('../Index')" ,
                        OnComplete = "complete" ,

                    } ) )
                    {
                        @Html.AntiForgeryToken( )

                        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                        <div class="margin-b section">
                        </div>

                        <div class="row margin-b hide">
                            <div class="input-field col s6 offset-s3">
                                <i class="p-size material-icons text-grey prefix">person</i>
                                @Html.LabelFor(model => model.idPK, htmlAttributes: new { @class = "control-label col-md-2" })

                                @Html.EditorFor(model => model.idPK, new { htmlAttributes = new { @class = "form-control" } })

                                @Html.ValidationMessageFor(model => model.idPK, "", new { @class = "text-danger" })

                            </div>
                        </div>

                        <div class="row margin-b">
                            <div class="input-field col s6 offset-s3">
                                <i class="p-size material-icons text-grey prefix">assignment_ind</i>
                                @Html.LabelFor(model => model.nombre, htmlAttributes: new { @class = "control-label col-md-2" })

                                @Html.EditorFor(model => model.nombre, new { htmlAttributes = new { @class = "form-control" } })

                                @Html.ValidationMessageFor(model => model.nombre, "", new { @class = "text-danger" })

                            </div>
                        </div>

                        <div class="row margin-b hide">
                            <div class="input-field col s6 offset-s3">
                                <i class="p-size material-icons text-grey prefix">person</i>
                                @Html.LabelFor(model => model.idPK, htmlAttributes: new { @class = "control-label col-md-2" })

                                @Html.EditorFor(model => model.idPK, new { htmlAttributes = new { @class = "form-control" } })

                                @Html.ValidationMessageFor(model => model.idPK, "", new { @class = "text-danger" })

                            </div>
                        </div>

                        <div class="row margin-b">
                            <div class="col s6 offset-s4">
                                @Html.LabelFor(model => model.cedulaClienteFK, htmlAttributes: new { @class = "control-label col-md-2" })

                            </div>

                            <div class="input-field ">
                                <div class="col s6 offset-s3">
                                    <i class="p-size material-icons text-grey prefix">person</i>
                                    @Html.DropDownList( "cedulaClienteFK" , clientsId , "Selecciona el cliente" )
                                    @Html.ValidationMessageFor(model => model.cedulaClienteFK, "", new { @class = "text-danger" })
                                </div>
                            </div>
                        </div>

                        <div class="row margin-b">
                            <div class="input-field col s6 offset-s3">
                                <i class="p-size material-icons text-grey prefix">person</i>
                                @Html.DropDownList("cedula_empleadoFK", leaders, "Selecciona el líder", new
                                {
                               @class = "validate"
                                })
                                @Html.ValidationMessageFor(model => model.cedulaClienteFK, "", new { @class = "text-error" })
                            </div>
                        </div>

                        <div class="row margin-b">
                            <div class="input-field col s6 offset-s3">
                                <i class="p-size material-icons text-grey prefix">assignment</i>

                                @Html.LabelFor(model => model.objetivo, htmlAttributes: new { @class = "control-label col-md-2" })

                                @Html.EditorFor(model => model.objetivo, new { htmlAttributes = new { @class = "form-control" } })

                                @Html.ValidationMessageFor(model => model.objetivo, "", new { @class = "text-danger" })

                            </div>
                        </div>

                        <div class="row margin-b">
                            <div class="input-field col s6 offset-s3">
                                <i class="p-size material-icons text-grey prefix">date_range</i>
                                <label for="fechaInicio">Fecha de Inicio</label>
                                <input type="text" value="@Model.fechaInicio" class="datepicker" id="fechaInicio" name="fechaInicio" />

                                @Html.ValidationMessageFor(model => model.fechaInicio, "", new { @class = "text-danger" })

                            </div>
                        </div>

                        <div class="row margin-b">
                            <div class="input-field col s6 offset-s3">
                                <i class="p-size material-icons text-grey prefix">date_range</i>
                                <label for="fechaFin">Fecha de Finalización</label>
                                <input type="text" class="datepicker" id="fechaFin" name="fechaFin" />

                                @Html.ValidationMessageFor(model => model.fechaFin, "", new { @class = "text-danger" })

                            </div>
                        </div>

                        <div class="row margin-b">
                            <div class="input-field col s6 offset-s3">

                                <i class="p-size material-icons text-grey prefix">info</i>

                                <select name="estado">
                                    <option value="" disabled selected>Estado del proyecto</option>
                                    <option value="Inactivo">Inactivo</option>
                                    <option value="Activo">Activo</option>
                                </select>

                                @Html.ValidationMessageFor(model => model.estado, "", new { @class = "text-danger" })

                            </div>
                        </div>

                        <div class="row margin-b">
                            <div class="input-field col s6 offset-s3">

                                <i class="p-size material-icons text-grey prefix">hourglass_empty</i>
                                @Html.LabelFor(model => model.duracionEstimada, htmlAttributes: new { @class = "control-label col-md-2" })

                                @Html.EditorFor(model => model.duracionEstimada, new { htmlAttributes = new { @class = "form-control" } })

                                @Html.ValidationMessageFor(model => model.duracionEstimada, "", new { @class = "text-danger" })

                            </div>
                        </div>

                        <div class="row margin-b">
                            <div class="input-field col s6 offset-s3">
                                <i class="p-size material-icons text-grey prefix">hourglass_full</i>
                                @Html.LabelFor(model => model.duracionReal, htmlAttributes: new { @class = "control-label col-md-2" })

                                @Html.EditorFor(model => model.duracionReal, new { htmlAttributes = new { @class = "form-control" } })

                                @Html.ValidationMessageFor(model => model.duracionReal, "", new { @class = "text-danger" })

                            </div>
                        </div>

                        <div class=" row container center" id="loading" style="display:none;">
                            <div class="">
                                <i class="material-icons text-turq ">info_outline</i>
                            </div>
                            <div class="">
                                <p class="text-turq">
                                    Editando... Por favor espere.
                                </p>
                            </div>

                            <div class="progress">
                                <div class="indeterminate"></div>
                            </div>
                        </div>

                        <div class=" row container center hide " id="complete">
                            <div class="">
                                <i class="material-icons text-turq ">info_outline</i>
                            </div>
                            <div class="">
                                <p class="text-turq">
                                    Se edito correctamente.
                                </p>
                            </div>
                        </div>

                        <div class="margin-b1">
                        </div>

                        <div class="row center">
                            @Html.ActionLink("Cancelar", "Details", new { id = Model.idPK }, new { @class = "margin-r waves-effect red-hover btn red accent-4"
                       } )
                            <button type="submit" class="margin-l waves-effect waves-light btn turq">Guardar</button>
                        </div>

                        <div class="margin-b section">
                        </div>
                    }

                </div>

            </div>

        </div>

    }
    else
    {
        <div class="row container center top-m-block">

            <div class="card hoverable s10 section">

                <h3>Lo sentimos.<br />Debes iniciar sesión como <span class="red-text"> jefe </span> para editar un proyecto.</h3>
                <i class="large material-icons red-text">block</i>

            </div>
        </div>
    }


}

<div>
    @Html.ActionLink( "Back to List" , "Index" )
</div>

@section Scripts {
    @Scripts.Render( "~/bundles/jqueryval" )
}
